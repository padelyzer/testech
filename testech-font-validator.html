<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TESTECH - Validador de Fuente Montserrat</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .validator-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        h1 {
            color: #1a237e;
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 40px;
        }
        
        .test-section {
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        
        .test-section h2 {
            color: #ff6f00;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .status-badge {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            color: white;
        }
        
        .status-badge.success {
            background: #27ae60;
        }
        
        .status-badge.error {
            background: #e74c3c;
        }
        
        .status-badge.warning {
            background: #f39c12;
        }
        
        .element-test {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            margin: 5px 0;
            background: white;
            border-radius: 5px;
            border-left: 4px solid #ddd;
        }
        
        .element-test.pass {
            border-left-color: #27ae60;
        }
        
        .element-test.fail {
            border-left-color: #e74c3c;
        }
        
        .element-info {
            flex: 1;
        }
        
        .element-name {
            font-weight: bold;
            color: #2c3e50;
        }
        
        .element-font {
            font-size: 12px;
            color: #7f8c8d;
            margin-top: 5px;
        }
        
        .test-result {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .icon {
            font-size: 20px;
        }
        
        .pass .icon { color: #27ae60; }
        .fail .icon { color: #e74c3c; }
        
        iframe {
            width: 100%;
            height: 600px;
            border: 2px solid #ddd;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .summary-box {
            background: linear-gradient(135deg, #1a237e, #3949ab);
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            margin: 30px 0;
        }
        
        .summary-stats {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-number {
            font-size: 36px;
            font-weight: bold;
        }
        
        .stat-label {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .check-button {
            background: #ff6f00;
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            display: block;
            margin: 30px auto;
        }
        
        .check-button:hover {
            background: #ff8f00;
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(255,111,0,0.3);
        }
        
        .loading {
            text-align: center;
            padding: 20px;
            color: #666;
        }
        
        .spinner {
            display: inline-block;
            width: 30px;
            height: 30px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #ff6f00;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="validator-container">
        <h1>üîç Validador de Fuente Montserrat - TESTECH v2</h1>
        
        <div class="summary-box">
            <h2 style="color: white; margin: 0;">Resumen de Validaci√≥n</h2>
            <div class="summary-stats">
                <div class="stat-item">
                    <div class="stat-number" id="total-elements">0</div>
                    <div class="stat-label">Elementos Totales</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="montserrat-count">0</div>
                    <div class="stat-label">Con Montserrat</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="success-rate">0%</div>
                    <div class="stat-label">Tasa de √âxito</div>
                </div>
            </div>
        </div>
        
        <button class="check-button" onclick="validateFonts()">
            üöÄ Ejecutar Validaci√≥n Completa
        </button>
        
        <div id="loading" class="loading" style="display: none;">
            <div class="spinner"></div>
            <p>Analizando elementos del sitio...</p>
        </div>
        
        <div id="test-results"></div>
        
        <iframe id="site-frame" src="testech-v2.html" style="display: none;"></iframe>
    </div>
    
    <script>
        function validateFonts() {
            const iframe = document.getElementById('site-frame');
            const loading = document.getElementById('loading');
            const resultsContainer = document.getElementById('test-results');
            
            // Mostrar loading
            loading.style.display = 'block';
            resultsContainer.innerHTML = '';
            iframe.style.display = 'block';
            
            // Esperar a que el iframe cargue
            iframe.onload = function() {
                setTimeout(() => {
                    performValidation();
                }, 1000);
            };
            
            // Recargar el iframe
            iframe.src = iframe.src;
        }
        
        function performValidation() {
            const iframe = document.getElementById('site-frame');
            const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
            const resultsContainer = document.getElementById('test-results');
            const loading = document.getElementById('loading');
            
            // Elementos a validar
            const elementsToCheck = [
                { selector: 'h1', name: 'T√≠tulos H1', expectedWeight: '800' },
                { selector: 'h2', name: 'T√≠tulos H2', expectedWeight: '700' },
                { selector: 'h3', name: 'T√≠tulos H3', expectedWeight: '600' },
                { selector: 'h4', name: 'T√≠tulos H4', expectedWeight: '600' },
                { selector: '.navbar-brand', name: 'Logo/Brand', expectedWeight: '800' },
                { selector: '.nav-link', name: 'Enlaces de navegaci√≥n', expectedWeight: '600' },
                { selector: '.hero-content h1', name: 'T√≠tulo Hero', expectedWeight: '800' },
                { selector: '.hero-content h2', name: 'Subt√≠tulo Hero', expectedWeight: '400' },
                { selector: '.btn-primary-custom', name: 'Bot√≥n Primario', expectedWeight: '700' },
                { selector: '.btn-secondary-custom', name: 'Bot√≥n Secundario', expectedWeight: '600' },
                { selector: '.stat-number', name: 'N√∫meros de estad√≠sticas', expectedWeight: '800' },
                { selector: '.stat-text', name: 'Texto de estad√≠sticas', expectedWeight: '600' },
                { selector: '.section-title', name: 'T√≠tulos de secci√≥n', expectedWeight: '800' },
                { selector: '.section-subtitle', name: 'Subt√≠tulos de secci√≥n', expectedWeight: '400' },
                { selector: '.service-card h3', name: 'T√≠tulos de servicios', expectedWeight: '700' },
                { selector: '.service-card .price', name: 'Precios', expectedWeight: '800' },
                { selector: '.case-card .roi', name: 'ROI en casos', expectedWeight: '800' },
                { selector: '.testimonial-text', name: 'Texto testimoniales', expectedWeight: '400' },
                { selector: '.accordion-button', name: 'Botones FAQ', expectedWeight: '600' },
                { selector: 'p', name: 'P√°rrafos', expectedWeight: '400' },
                { selector: 'input', name: 'Campos de formulario', expectedWeight: '400' },
                { selector: 'button', name: 'Botones', expectedWeight: '700' },
                { selector: 'footer', name: 'Footer', expectedWeight: '400' }
            ];
            
            let results = {};
            let totalElements = 0;
            let montserratElements = 0;
            
            // Agrupar resultados por categor√≠as
            const categories = {
                'Encabezados': [],
                'Navegaci√≥n': [],
                'Botones y CTAs': [],
                'Contenido': [],
                'Formularios': [],
                'Componentes': []
            };
            
            elementsToCheck.forEach(item => {
                const elements = iframeDoc.querySelectorAll(item.selector);
                if (elements.length > 0) {
                    const element = elements[0];
                    const computedStyle = iframe.contentWindow.getComputedStyle(element);
                    const fontFamily = computedStyle.fontFamily;
                    const fontWeight = computedStyle.fontWeight;
                    
                    const hasMontserrat = fontFamily.toLowerCase().includes('montserrat');
                    totalElements++;
                    if (hasMontserrat) montserratElements++;
                    
                    const result = {
                        name: item.name,
                        count: elements.length,
                        fontFamily: fontFamily,
                        fontWeight: fontWeight,
                        expectedWeight: item.expectedWeight,
                        hasMontserrat: hasMontserrat,
                        weightCorrect: fontWeight === item.expectedWeight || 
                                      (fontWeight === 'normal' && item.expectedWeight === '400') ||
                                      (fontWeight === 'bold' && item.expectedWeight === '700')
                    };
                    
                    // Categorizar
                    if (item.selector.includes('h1') || item.selector.includes('h2') || 
                        item.selector.includes('h3') || item.selector.includes('h4') || 
                        item.selector.includes('title')) {
                        categories['Encabezados'].push(result);
                    } else if (item.selector.includes('nav') || item.selector.includes('brand')) {
                        categories['Navegaci√≥n'].push(result);
                    } else if (item.selector.includes('btn') || item.selector.includes('button')) {
                        categories['Botones y CTAs'].push(result);
                    } else if (item.selector.includes('input') || item.selector.includes('form')) {
                        categories['Formularios'].push(result);
                    } else if (item.selector === 'p' || item.selector.includes('text')) {
                        categories['Contenido'].push(result);
                    } else {
                        categories['Componentes'].push(result);
                    }
                }
            });
            
            // Actualizar resumen
            document.getElementById('total-elements').textContent = totalElements;
            document.getElementById('montserrat-count').textContent = montserratElements;
            document.getElementById('success-rate').textContent = 
                Math.round((montserratElements / totalElements) * 100) + '%';
            
            // Mostrar resultados por categor√≠a
            resultsContainer.innerHTML = '';
            
            Object.keys(categories).forEach(category => {
                if (categories[category].length > 0) {
                    const section = document.createElement('div');
                    section.className = 'test-section';
                    
                    const allPass = categories[category].every(r => r.hasMontserrat);
                    const statusClass = allPass ? 'success' : 'warning';
                    const statusText = allPass ? '‚úÖ Completo' : '‚ö†Ô∏è Parcial';
                    
                    section.innerHTML = `
                        <h2>
                            ${category}
                            <span class="status-badge ${statusClass}">${statusText}</span>
                        </h2>
                    `;
                    
                    categories[category].forEach(result => {
                        const testDiv = document.createElement('div');
                        testDiv.className = `element-test ${result.hasMontserrat ? 'pass' : 'fail'}`;
                        testDiv.innerHTML = `
                            <div class="element-info">
                                <div class="element-name">${result.name} (${result.count} elementos)</div>
                                <div class="element-font">
                                    Fuente: ${result.fontFamily.split(',')[0]}
                                    | Peso: ${result.fontWeight} ${result.weightCorrect ? '‚úì' : '(esperado: ' + result.expectedWeight + ')'}
                                </div>
                            </div>
                            <div class="test-result">
                                <span class="icon">${result.hasMontserrat ? '‚úÖ' : '‚ùå'}</span>
                            </div>
                        `;
                        section.appendChild(testDiv);
                    });
                    
                    resultsContainer.appendChild(section);
                }
            });
            
            // Ocultar loading
            loading.style.display = 'none';
            
            // Mensaje final
            const successRate = (montserratElements / totalElements) * 100;
            let finalMessage = '';
            
            if (successRate === 100) {
                finalMessage = `
                    <div class="test-section" style="background: linear-gradient(135deg, #27ae60, #2ecc71); color: white;">
                        <h2 style="color: white;">üéâ ¬°Validaci√≥n Exitosa!</h2>
                        <p>Todos los elementos est√°n usando la fuente Montserrat correctamente.</p>
                    </div>
                `;
            } else if (successRate >= 90) {
                finalMessage = `
                    <div class="test-section" style="background: linear-gradient(135deg, #f39c12, #f1c40f); color: white;">
                        <h2 style="color: white;">‚ö†Ô∏è Casi Perfecto</h2>
                        <p>${100 - Math.round(successRate)}% de elementos necesitan ajustes menores.</p>
                    </div>
                `;
            } else {
                finalMessage = `
                    <div class="test-section" style="background: linear-gradient(135deg, #e74c3c, #c0392b); color: white;">
                        <h2 style="color: white;">‚ùå Se Requieren Ajustes</h2>
                        <p>${100 - Math.round(successRate)}% de elementos no est√°n usando Montserrat.</p>
                    </div>
                `;
            }
            
            resultsContainer.innerHTML += finalMessage;
        }
        
        // Auto-ejecutar al cargar
        window.onload = function() {
            console.log('%cüîç Validador de Fuentes TESTECH Cargado', 'color: #ff6f00; font-size: 18px; font-weight: bold;');
            console.log('Haz clic en "Ejecutar Validaci√≥n Completa" para comenzar');
        };
    </script>
</body>
</html>